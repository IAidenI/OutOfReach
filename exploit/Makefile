# ================== Config commune ==================
CC         = gcc
TARGET     = exploit
SOURCEDIR  = sources
HEADERSDIR = headers

SOURCES := $(wildcard $(SOURCEDIR)/*.c) $(TARGET).c
OBJECTS := $(SOURCES:.c=.o)

CFLAGS  = -Wall -I$(HEADERSDIR)
LDFLAGS =
LDLIBS  =

# ================== RÃ¨gles ==================
.PHONY: all clean run

all: $(TARGET)$(EXE)
	@echo "Binary ready ! -> $(TARGET)$(EXE)"
	@$(MAKE) --no-print-directory clean

$(TARGET)$(EXE): $(OBJECTS)
	@echo "Compiling and linking $(TARGET)..."
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS) $(LDLIBS)

%.o: %.c $(HEADERSDIR)/*.h
	@echo "Compiling $<..."
	$(CC) $(CFLAGS) -c $< -o $@

clean:
	@echo "Cleaning object files..."
	-$(RM) $(OBJECTS)

run: $(TARGET)$(EXE)
	$(RUN_PREFIX)$(TARGET)$(EXE)
